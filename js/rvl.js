const translations = {
  ru: {
    "topbar.badge":"Гос. учреждение",
    "topbar.adilet":"Adilet",
    "topbar.goszakup":"Госзакуп",
    "brand.name":"Республиканская ветеринарная лаборатория",
    "brand.sub":"Официальный веб-ресурс",
    "nav.home":"Главная",
    "nav.about":"О лаборатории",
    "nav.branches":"Структура и филиалы",
    "nav.services":"Услуги",
    "nav.training":"Учебно-методический центр",
    "nav.laws":"НПА",
    "nav.news":"Новости",
    "nav.contacts":"Контакты",
    "nav.proposals":"Предложения",
    "hero.title":"Экспертиза ветеринарной лабораторной диагностики",
    "hero.desc":"Современные методы исследований, точность результатов и соответствие требованиям государственного веб-ресурса.",
    "hero.cta1":"Услуги и направления",
    "hero.cta2":"Обратная связь",
    "hero.stat1":"видов исследований",
    "hero.stat2":"приём заявок",
    "hero.stat3":"3 языка",
    "hero.badge":"Научно-деловой официальный стиль",
    "services.title":"Услуги и направления",
    "services.all":"Смотреть все →",
    "services.s1":"Гематология",
    "services.s2":"Биохимия",
    "services.s3":"ПЦР диагностика",
    "services.s4":"Микробиология",
    "services.note":"Изображения для карточек услуг: 1200×800 (соотношение 3:2), формат WebP/JPG, без текста на фото.",
    "laws.title":"Нормативные правовые акты",
    "laws.sub":"Интеграция с внешними ресурсами",
    "laws.adilet":"База НПА — Adilet",
    "laws.adiletDesc":"Официальные нормативные документы",
    "laws.gos":"Госзакупки",
    "laws.gosDesc":"Информация о закупках и процедурах",
    "contact.title":"Контакты и обратная связь",
    "contact.infoTitle":"Для связи",
    "contact.infoText":"Вы можете отправить обращение через форму или связаться по телефону.",
    "contact.phone":"Телефон",
    "contact.email":"Email",
    "contact.formTitle":"Форма обращения",
    "form.name":"Имя",
    "form.email":"Email",
    "form.message":"Сообщение",
    "form.send":"Отправить",
    "form.hint":"На бэкенде подключим безопасную отправку (валидация + защита).",
    "footer.title":"Официальный сайт",
    "footer.text":"Ветеринарная лаборатория. Адаптивный дизайн, 3 языка, SEO-дружественная структура.",
    "footer.links":"Ссылки",
    "footer.external":"Внешние ресурсы",
    "footer.rights":"Все права защищены",
    
    // НОВЫЕ ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ УСЛУГ
    "services.page.title": "Услуги и направления",
    "services.filter.category": "Категория",
    "services.filter.search": "Поиск услуги...",
    "services.filter.all": "Все",
    "services.filter.reset": "Сбросить",
    "services.filter.lab": "Лаборатория",
    "services.filter.pcr": "ПЦР",
    "services.filter.micro": "Микробиология",
    "services.filter.bio": "Биохимия",
    "services.filter.hema": "Гематология",
    "services.filter.consult": "Сопровождение",
    "services.empty": "Услуги не найдены",
    "services.btn.request": "Запросить услугу",
    "services.btn.contact": "Связаться",
    "services.hema.title": "Гематологические исследования",
    "services.hema.desc": "Исследования крови животных: основные показатели, оценка состояния организма.",
    "services.bio.title": "Биохимические исследования",
    "services.bio.desc": "Показатели биохимии: ферменты, белки, электролиты и другие параметры.",
    "services.pcr.title": "ПЦР диагностика",
    "services.pcr.desc": "Молекулярная диагностика инфекций и патогенов с высокой точностью.",
    "services.micro.title": "Микробиологические исследования",
    "services.micro.desc": "Выделение культур, идентификация, тестирование чувствительности к препаратам.",
    "services.sero.title": "Серологические исследования",
    "services.sero.desc": "Оценка иммунного ответа, выявление антител, мониторинг заболеваний.",
    "services.support.title": "Методическое сопровождение",
    "services.support.desc": "Консультации, разъяснения, методические материалы и обучение.",
    
    // ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ НОВОСТЕЙ
    "news.pageTitle": "Новости — Республиканская ветеринарная лаборатория",
    "news.title": "Новости",
    "news.lead": "Официальные новости, объявления и пресс-релизы.",
    "news.search.placeholder": "Поиск по новостям...",
    "news.category.label": "Категория",
    "news.cat.all": "Все",
    "news.cat.official": "Официально",
    "news.cat.announce": "Объявления",
    "news.cat.press": "Пресс-релизы",
    "news.reset": "Сбросить",
    "news.readMore": "Читать подробнее →",
    "news.empty.title": "Ничего не найдено",
    "news.empty.desc": "Попробуйте изменить запрос или выбрать другую категорию.",
    "news.tag.official": "Официально",
    "news.tag.announce": "Объявление",
    "news.tag.press": "Пресс-релиз",
    
    // ОБНОВЛЕННЫЕ ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ "О ЛАБОРАТОРИИ"
    "about.title": "О лаборатории",
    "about.lead": "Республиканская ветеринарная лаборатория выполняет лабораторную диагностику и экспертные исследования.",
    "about.mission.title": "Миссия",
    "about.mission.text": "Обеспечение ветеринарной и биологической безопасности через качественную лабораторную диагностику.",
    "about.tasks.title": "Задачи",
    "about.tasks.li1": "Проведение лабораторных исследований и экспертиз.",
    "about.tasks.li2": "Мониторинг и выявление заболеваний животных.",
    "about.tasks.li3": "Методическая поддержка и обучение специалистов.",
    "about.directions.title": "Основные направления",
    "about.directions.d1": "Лабораторная диагностика",
    "about.directions.d1t": "ПЦР, биохимия, микробиология и другие исследования.",
    "about.directions.d2": "Экспертная оценка",
    "about.directions.d2t": "Подготовка заключений и консультации.",
    "about.directions.d3": "Сопровождение",
    "about.directions.d3t": "Методические материалы и учебные программы.",

    // ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ "СТРУКТУРА И ФИЛИАЛЫ"
    "branches.title": "Структура и филиалы",
    "branches.lead": "Информация о структурных подразделениях и филиальной сети.",
    "branches.structure.title": "Структура",
    "branches.structure.s1": "Центральная лаборатория",
    "branches.structure.s1t": "Основные исследования и экспертизы.",
    "branches.structure.s2": "Отдел качества",
    "branches.structure.s2t": "Контроль и стандарты лабораторных процедур.",
    "branches.structure.s3": "Методический отдел",
    "branches.structure.s3t": "Документы, протоколы, обучение.",
    "branches.list.title": "Филиалы",
    "branches.list.sub": "Обновим список после согласования",
    "branches.list.addr": "Адрес и контакты филиала",

    // ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ "УЧЕБНО-МЕТОДИЧЕСКИЙ ЦЕНТР"
    "training.title": "Учебно-методический центр",
    "training.lead": "Обучение, методические материалы и повышение квалификации специалистов.",
    "training.p1.title": "Курсы",
    "training.p1.text": "Программы повышения квалификации и семинары.",
    "training.p2.title": "Методические материалы",
    "training.p2.text": "Документы, протоколы и инструкции.",
    "training.p3.title": "Заявка на обучение",
    "training.p3.text": "Оставьте заявку — мы свяжемся и уточним детали.",
    "training.form.title": "Заявка",
    "training.form.name": "Имя",
    "training.form.namePh": "Иван",
    "training.form.phone": "Телефон",
    "training.form.phonePh": "+7...",
    "training.form.topic": "Тема",
    "training.form.topicPh": "Курс/семинар",
    "training.form.send": "Отправить",
    "training.form.hint": "Заявка будет обработана в рабочее время.",

    // ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ "ПРЕДЛОЖЕНИЯ"
    "proposals.title": "Предложения",
    "proposals.lead": "Оставьте предложение по улучшению работы сайта или деятельности организации.",
    "proposals.form.title": "Форма предложения",
    "proposals.form.name": "Имя",
    "proposals.form.namePh": "Иван",
    "proposals.form.email": "Email",
    "proposals.form.emailPh": "name@email.com",
    "proposals.form.message": "Предложение",
    "proposals.form.messagePh": "Введите текст...",
    "proposals.form.send": "Отправить",
    "proposals.form.hint": "Сообщение будет направлено ответственному специалисту.",

    // ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ КОНТАКТОВ
    "contacts.title": "Контакты",
    "contacts.lead": "Свяжитесь с нами по телефону или отправьте обращение через форму.",
    "contacts.info.title": "Контактная информация",
    "contacts.info.phone": "Телефон",
    "contacts.info.email": "Email",
    "contacts.info.address": "Адрес",
    "contacts.info.addressValue": "Казахстан, г. Астана, (уточнить адрес)",
    "contacts.info.hours": "Режим работы",
    "contacts.info.hoursValue": "Пн–Пт: 09:00–18:00, Сб–Вс: выходной",
    "contacts.btn.email": "Написать письмо",
    "contacts.btn.call": "Позвонить",
    "contacts.map.title": "Карта",
    "contacts.map.stubTitle": "Карта будет добавлена",
    "contacts.map.stubText": "После согласования адреса подключим Яндекс/Google карты.",
    "contacts.map.hint": "Для навигации используйте адрес или позвоните в приёмную.",
    "contacts.form.title": "Форма обращения",
    "contacts.form.lead": "Заполните форму, и мы ответим в рабочее время.",
    "contacts.form.name": "Имя",
    "contacts.form.namePh": "Ваше имя",
    "contacts.form.email": "Email",
    "contacts.form.emailPh": "name@email.com",
    "contacts.form.subject": "Тема",
    "contacts.form.subjectPh": "Вопрос по услугам / сотрудничеству",
    "contacts.form.message": "Сообщение",
    "contacts.form.messagePh": "Введите сообщение...",
    "contacts.form.send": "Отправить",
    "contacts.form.hint": "На бэкенде подключим безопасную отправку (валидация + защита)."
  },

  kz: {
    "topbar.badge":"Мемлекеттік мекеме",
    "topbar.adilet":"Adilet",
    "topbar.goszakup":"Мемсатып алу",
    "brand.name":"Республикалық ветеринариялық зертхана",
    "brand.sub":"Ресми веб-ресурс",
    "nav.home":"Басты бет",
    "nav.about":"Зертхана туралы",
    "nav.branches":"Құрылымы және филиалдар",
    "nav.services":"Қызметтер",
    "nav.training":"Оқу-әдістемелік орталық",
    "nav.laws":"НҚА",
    "nav.news":"Жаңалықтар",
    "nav.contacts":"Байланыс",
    "nav.proposals":"Ұсыныстар",
    "hero.title":"Ветеринариялық зертханалық диагностика сараптамасы",
    "hero.desc":"Зерттеудің заманауи әдістері, нәтижелердің дәлдігі және мемлекеттік веб-ресурс талаптарына сәйкестік.",
    "hero.cta1":"Қызметтер мен бағыттар",
    "hero.cta2":"Кері байланыс",
    "hero.stat1":"зерттеу түрі",
    "hero.stat2":"өтінім қабылдау",
    "hero.stat3":"3 тіл",
    "hero.badge":"Ғылыми-іскерлік ресми стиль",
    "services.title":"Қызметтер мен бағыттар",
    "services.all":"Барлығын көру →",
    "services.s1":"Гематология",
    "services.s2":"Биохимия",
    "services.s3":"ПТР диагностика",
    "services.s4":"Микробиология",
    "services.note":"Қызмет карталары үшін сурет: 1200×800 (3:2), WebP/JPG, суретте мәтінсіз.",
    "laws.title":"Нормативтік құқықтық актілер",
    "laws.sub":"Сыртқы ресурстармен интеграция",
    "laws.adilet":"НҚА базасы — Adilet",
    "laws.adiletDesc":"Ресми нормативтік құжаттар",
    "laws.gos":"Мемлекеттік сатып алу",
    "laws.gosDesc":"Сатып алу және рәсімдер туралы ақпарат",
    "contact.title":"Байланыс және кері байланыс",
    "contact.infoTitle":"Байланыс үшін",
    "contact.infoText":"Өтінімді форма арқылы жіберіңіз немесе телефонмен хабарласыңыз.",
    "contact.phone":"Телефон",
    "contact.email":"Email",
    "contact.formTitle":"Өтінім формасы",
    "form.name":"Аты",
    "form.email":"Email",
    "form.message":"Хабарлама",
    "form.send":"Жіберу",
    "form.hint":"Бэкендте қауіпсіз жіберуді қосамыз (валидация + қорғаныс).",
    "footer.title":"Ресми сайт",
    "footer.text":"Ветеринариялық зертхана. Адаптивті дизайн, 3 тіл, SEO-құрылым.",
    "footer.links":"Сілтемелер",
    "footer.external":"Сыртқы ресурстар",
    "footer.rights":"Барлық құқық қорғалған",
    
    // НОВЫЕ ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ УСЛУГ
    "services.page.title": "Қызметтер мен бағыттар",
    "services.filter.category": "Санат",
    "services.filter.search": "Қызметті іздеу...",
    "services.filter.all": "Барлығы",
    "services.filter.reset": "Тазалау",
    "services.filter.lab": "Зертхана",
    "services.filter.pcr": "ПТР",
    "services.filter.micro": "Микробиология",
    "services.filter.bio": "Биохимия",
    "services.filter.hema": "Гематология",
    "services.filter.consult": "Сүйемелдеу",
    "services.empty": "Қызметтер табылмады",
    "services.btn.request": "Қызметке өтінім беру",
    "services.btn.contact": "Байланысу",
    "services.hema.title": "Гематологиялық зерттеулер",
    "services.hema.desc": "Жануар қанының негізгі көрсеткіштері және организм жағдайын бағалау.",
    "services.bio.title": "Биохимиялық зерттеулер",
    "services.bio.desc": "Ферменттер, ақуыздар, электролиттер және басқа да биохимиялық көрсеткіштер.",
    "services.pcr.title": "ПТР диагностика",
    "services.pcr.desc": "Инфекциялар мен қоздырғыштарды жоғары дәлдікпен молекулалық анықтау.",
    "services.micro.title": "Микробиологиялық зерттеулер",
    "services.micro.desc": "Дақыл бөлу, сәйкестендіру және препараттарға сезімталдықты анықтау.",
    "services.sero.title": "Серологиялық зерттеулер",
    "services.sero.desc": "Антиденелерді анықтау, иммундық жауапты бағалау және мониторинг.",
    "services.support.title": "Әдістемелік сүйемелдеу",
    "services.support.desc": "Кеңес беру, түсіндіру, әдістемелік материалдар және оқыту.",
    
    // ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ НОВОСТЕЙ
    "news.pageTitle": "Жаңалықтар — Республикалық ветеринариялық зертхана",
    "news.title": "Жаңалықтар",
    "news.lead": "Ресми жаңалықтар, хабарландырулар және баспасөз хабарламалары.",
    "news.search.placeholder": "Жаңалықтарды іздеу...",
    "news.category.label": "Санат",
    "news.cat.all": "Барлығы",
    "news.cat.official": "Ресми",
    "news.cat.announce": "Хабарландырулар",
    "news.cat.press": "Баспасөз хабарламалары",
    "news.reset": "Тазарту",
    "news.readMore": "Толығырақ оқу →",
    "news.empty.title": "Ештеңе табылмады",
    "news.empty.desc": "Сұрауды өзгертіп көріңіз немесе басқа санатты таңдаңыз.",
    "news.tag.official": "Ресми",
    "news.tag.announce": "Хабарландыру",
    "news.tag.press": "Баспасөз хабарламасы",

    // ОБНОВЛЕННЫЕ ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ "О ЛАБОРАТОРИИ"
    "about.title": "Зертхана туралы",
    "about.lead": "Республикалық ветеринариялық зертхана зертханалық диагностика және сараптамалық зерттеулер жүргізеді.",
    "about.mission.title": "Миссия",
    "about.mission.text": "Сапалы зертханалық диагностика арқылы ветеринариялық және биологиялық қауіпсіздікті қамтамасыз ету.",
    "about.tasks.title": "Міндеттер",
    "about.tasks.li1": "Зертханалық зерттеулер мен сараптамалар жүргізу.",
    "about.tasks.li2": "Жануарлар ауруларын бақылау және анықтау.",
    "about.tasks.li3": "Мамандарды әдістемелік қолдау және оқыту.",
    "about.directions.title": "Негізгі бағыттар",
    "about.directions.d1": "Зертханалық диагностика",
    "about.directions.d1t": "ПТР, биохимия, микробиология және басқа зерттеулер.",
    "about.directions.d2": "Сараптамалық бағалау",
    "about.directions.d2t": "Қорытындылар дайындау және кеңес беру.",
    "about.directions.d3": "Сүйемелдеу",
    "about.directions.d3t": "Әдістемелік материалдар мен оқу бағдарламалары.",

    // ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ "СТРУКТУРА И ФИЛИАЛЫ"
    "branches.title": "Құрылымы және филиалдар",
    "branches.lead": "Құрылымдық бөлімшелер мен филиалдық желі туралы ақпарат.",
    "branches.structure.title": "Құрылым",
    "branches.structure.s1": "Орталық зертхана",
    "branches.structure.s1t": "Негізгі зерттеулер мен сараптамалар.",
    "branches.structure.s2": "Сапа бөлімі",
    "branches.structure.s2t": "Бақылау және зертханалық стандарттар.",
    "branches.structure.s3": "Әдістемелік бөлім",
    "branches.structure.s3t": "Құжаттар, хаттамалар, оқыту.",
    "branches.list.title": "Филиалдар",
    "branches.list.sub": "Тізімді келісімнен кейін жаңартамыз",
    "branches.list.addr": "Филиалдың мекенжайы мен байланысы",

    // ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ "УЧЕБНО-МЕТОДИЧЕСКИЙ ЦЕНТР"
    "training.title": "Оқу-әдістемелік орталық",
    "training.lead": "Оқыту, әдістемелік материалдар және біліктілікті арттыру.",
    "training.p1.title": "Курстар",
    "training.p1.text": "Біліктілікті арттыру бағдарламалары мен семинарлар.",
    "training.p2.title": "Әдістемелік материалдар",
    "training.p2.text": "Құжаттар, хаттамалар және нұсқаулықтар.",
    "training.p3.title": "Оқытуға өтінім",
    "training.p3.text": "Өтінім қалдырыңыз — біз байланысып, нақтылаймыз.",
    "training.form.title": "Өтінім",
    "training.form.name": "Аты",
    "training.form.namePh": "Аян",
    "training.form.phone": "Телефон",
    "training.form.phonePh": "+7...",
    "training.form.topic": "Тақырып",
    "training.form.topicPh": "Курс/семинар",
    "training.form.send": "Жіберу",
    "training.form.hint": "Өтінім жұмыс уақытында өңделеді.",

    // ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ "ПРЕДЛОЖЕНИЯ"
    "proposals.title": "Ұсыныстар",
    "proposals.lead": "Сайтты немесе ұйым жұмысын жақсарту бойынша ұсыныс қалдырыңыз.",
    "proposals.form.title": "Ұсыныс формасы",
    "proposals.form.name": "Аты",
    "proposals.form.namePh": "Аян",
    "proposals.form.email": "Email",
    "proposals.form.emailPh": "name@email.com",
    "proposals.form.message": "Ұсыныс",
    "proposals.form.messagePh": "Мәтінді енгізіңіз...",
    "proposals.form.send": "Жіберу",
    "proposals.form.hint": "Хабарлама жауапты маманға жіберіледі.",

    // ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ КОНТАКТОВ
    "contacts.title": "Байланыс",
    "contacts.lead": "Телефон арқылы хабарласыңыз немесе форма арқылы өтінім жіберіңіз.",
    "contacts.info.title": "Байланыс ақпараты",
    "contacts.info.phone": "Телефон",
    "contacts.info.email": "Email",
    "contacts.info.address": "Мекенжай",
    "contacts.info.addressValue": "Қазақстан, Астана қ., (мекенжайды нақтылау)",
    "contacts.info.hours": "Жұмыс уақыты",
    "contacts.info.hoursValue": "Дс–Жм: 09:00–18:00, Сб–Жс: демалыс",
    "contacts.btn.email": "Хат жазу",
    "contacts.btn.call": "Қоңырау шалу",
    "contacts.map.title": "Карта",
    "contacts.map.stubTitle": "Карта кейін қосылады",
    "contacts.map.stubText": "Мекенжай келісілгеннен кейін Яндекс/Google картасын қосамыз.",
    "contacts.map.hint": "Навигация үшін мекенжайды пайдаланыңыз немесе қабылдау бөліміне қоңырау шалыңыз.",
    "contacts.form.title": "Өтінім формасы",
    "contacts.form.lead": "Форманы толтырыңыз — біз жұмыс уақытында жауап береміз.",
    "contacts.form.name": "Аты",
    "contacts.form.namePh": "Атыңыз",
    "contacts.form.email": "Email",
    "contacts.form.emailPh": "name@email.com",
    "contacts.form.subject": "Тақырып",
    "contacts.form.subjectPh": "Қызмет / ынтымақтастық туралы сұрақ",
    "contacts.form.message": "Хабарлама",
    "contacts.form.messagePh": "Хабарламаны енгізіңіз...",
    "contacts.form.send": "Жіберу",
    "contacts.form.hint": "Бэкендте қауіпсіз жіберуді қосамыз (валидация + қорғаныс)."
  },

  en: {
    "topbar.badge":"Government institution",
    "topbar.adilet":"Adilet",
    "topbar.goszakup":"Public procurement",
    "brand.name":"Republic Veterinary Laboratory",
    "brand.sub":"Official web resource",
    "nav.home":"Home",
    "nav.about":"About",
    "nav.branches":"Structure & branches",
    "nav.services":"Services",
    "nav.training":"Training center",
    "nav.laws":"Legal acts",
    "nav.news":"News",
    "nav.contacts":"Contacts",
    "nav.proposals":"Proposals",
    "hero.title":"Veterinary laboratory diagnostics expertise",
    "hero.desc":"Modern research methods, accurate results and compliance with official web requirements.",
    "hero.cta1":"Services & directions",
    "hero.cta2":"Feedback",
    "hero.stat1":"research types",
    "hero.stat2":"requests",
    "hero.stat3":"3 languages",
    "hero.badge":"Scientific & official style",
    "services.title":"Services & directions",
    "services.all":"View all →",
    "services.s1":"Hematology",
    "services.s2":"Biochemistry",
    "services.s3":"PCR diagnostics",
    "services.s4":"Microbiology",
    "services.note":"Service card images: 1200×800 (3:2), WebP/JPG, no text on photos.",
    "laws.title":"Legal acts",
    "laws.sub":"Integration with external resources",
    "laws.adilet":"Legal database — Adilet",
    "laws.adiletDesc":"Official legal documents",
    "laws.gos":"Public procurement",
    "laws.gosDesc":"Procurement information and procedures",
    "contact.title":"Contacts & feedback",
    "contact.infoTitle":"Contact info",
    "contact.infoText":"Send a request via the form or contact by phone.",
    "contact.phone":"Phone",
    "contact.email":"Email",
    "contact.formTitle":"Feedback form",
    "form.name":"Name",
    "form.email":"Email",
    "form.message":"Message",
    "form.send":"Send",
    "form.hint":"We will connect secure delivery on the backend (validation + protection).",
    "footer.title":"Official website",
    "footer.text":"Veterinary laboratory. Responsive design, 3 languages, SEO-friendly structure.",
    "footer.links":"Links",
    "footer.external":"External resources",
    "footer.rights":"All rights reserved",
    
    // НОВЫЕ ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ УСЛУГ
    "services.page.title": "Services & directions",
    "services.filter.category": "Category",
    "services.filter.search": "Search service...",
    "services.filter.all": "All",
    "services.filter.reset": "Reset",
    "services.filter.lab": "Laboratory",
    "services.filter.pcr": "PCR",
    "services.filter.micro": "Microbiology",
    "services.filter.bio": "Biochemistry",
    "services.filter.hema": "Hematology",
    "services.filter.consult": "Support",
    "services.empty": "No services found",
    "services.btn.request": "Request service",
    "services.btn.contact": "Contact",
    "services.hema.title": "Hematology tests",
    "services.hema.desc": "Blood testing: key indicators and assessment of animal health status.",
    "services.bio.title": "Biochemistry tests",
    "services.bio.desc": "Biochemistry markers: enzymes, proteins, electrolytes and other parameters.",
    "services.pcr.title": "PCR diagnostics",
    "services.pcr.desc": "High-accuracy molecular diagnostics of infections and pathogens.",
    "services.micro.title": "Microbiology tests",
    "services.micro.desc": "Culture isolation, identification, and antimicrobial susceptibility testing.",
    "services.sero.title": "Serology tests",
    "services.sero.desc": "Immune response assessment, antibody detection, and disease monitoring.",
    "services.support.title": "Methodological support",
    "services.support.desc": "Consultations, guidance, materials, and training.",
    
    // ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ НОВОСТЕЙ
    "news.pageTitle": "News — Republic Veterinary Laboratory",
    "news.title": "News",
    "news.lead": "Official news, announcements, and press releases.",
    "news.search.placeholder": "Search news...",
    "news.category.label": "Category",
    "news.cat.all": "All",
    "news.cat.official": "Official",
    "news.cat.announce": "Announcements",
    "news.cat.press": "Press releases",
    "news.reset": "Reset",
    "news.readMore": "Read more →",
    "news.empty.title": "Nothing found",
    "news.empty.desc": "Try changing the query or selecting another category.",
    "news.tag.official": "Official",
    "news.tag.announce": "Announcement",
    "news.tag.press": "Press release",

    // ОБНОВЛЕННЫЕ ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ "О ЛАБОРАТОРИИ"
    "about.title": "About the Laboratory",
    "about.lead": "The Republican Veterinary Laboratory conducts laboratory diagnostics and expert research.",
    "about.mission.title": "Mission",
    "about.mission.text": "Ensuring veterinary and biological safety through high-quality laboratory diagnostics.",
    "about.tasks.title": "Objectives",
    "about.tasks.li1": "Conducting laboratory research and expert examinations.",
    "about.tasks.li2": "Monitoring and detection of animal diseases.",
    "about.tasks.li3": "Methodological support and professional training.",
    "about.directions.title": "Key Areas",
    "about.directions.d1": "Laboratory diagnostics",
    "about.directions.d1t": "PCR, biochemistry, microbiology, and other studies.",
    "about.directions.d2": "Expert evaluation",
    "about.directions.d2t": "Preparation of conclusions and consultations.",
    "about.directions.d3": "Support",
    "about.directions.d3t": "Methodological materials and training programs.",

    // ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ "СТРУКТУРА И ФИЛИАЛЫ"
    "branches.title": "Structure & branches",
    "branches.lead": "Information about departments and branch network.",
    "branches.structure.title": "Structure",
    "branches.structure.s1": "Central laboratory",
    "branches.structure.s1t": "Core testing and expert examinations.",
    "branches.structure.s2": "Quality department",
    "branches.structure.s2t": "Quality control and laboratory standards.",
    "branches.structure.s3": "Methodology unit",
    "branches.structure.s3t": "Documents, protocols and training.",
    "branches.list.title": "Branches",
    "branches.list.sub": "We will update the list after approval",
    "branches.list.addr": "Branch address and contacts",

    // ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ "УЧЕБНО-МЕТОДИЧЕСКИЙ ЦЕНТР"
    "training.title": "Training center",
    "training.lead": "Training, guidelines and professional development.",
    "training.p1.title": "Courses",
    "training.p1.text": "Professional development programs and seminars.",
    "training.p2.title": "Methodological materials",
    "training.p2.text": "Documents, protocols and instructions.",
    "training.p3.title": "Training request",
    "training.p3.text": "Submit a request — we will contact you and уточнить details.",
    "training.form.title": "Request form",
    "training.form.name": "Name",
    "training.form.namePh": "John",
    "training.form.phone": "Phone",
    "training.form.phonePh": "+7...",
    "training.form.topic": "Topic",
    "training.form.topicPh": "Course/Seminar",
    "training.form.send": "Send",
    "training.form.hint": "Requests are processed during business hours.",

    // ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ "ПРЕДЛОЖЕНИЯ"
    "proposals.title": "Proposals",
    "proposals.lead": "Submit your proposal to improve the website or the organization's work.",
    "proposals.form.title": "Proposal form",
    "proposals.form.name": "Name",
    "proposals.form.namePh": "John",
    "proposals.form.email": "Email",
    "proposals.form.emailPh": "name@email.com",
    "proposals.form.message": "Proposal",
    "proposals.form.messagePh": "Enter your message...",
    "proposals.form.send": "Send",
    "proposals.form.hint": "Your message will be forwarded to the responsible specialist.",

    // ПЕРЕВОДЫ ДЛЯ СТРАНИЦЫ КОНТАКТОВ
    "contacts.title": "Contacts",
    "contacts.lead": "Contact us by phone or send a request via the form.",
    "contacts.info.title": "Contact information",
    "contacts.info.phone": "Phone",
    "contacts.info.email": "Email",
    "contacts.info.address": "Address",
    "contacts.info.addressValue": "Kazakhstan, Astana (address to be confirmed)",
    "contacts.info.hours": "Working hours",
    "contacts.info.hoursValue": "Mon–Fri: 09:00–18:00, Sat–Sun: closed",
    "contacts.btn.email": "Send email",
    "contacts.btn.call": "Call",
    "contacts.map.title": "Map",
    "contacts.map.stubTitle": "Map will be added",
    "contacts.map.stubText": "After the address is confirmed, we will add Yandex/Google Maps.",
    "contacts.map.hint": "Use the address for navigation or call the reception desk.",
    "contacts.form.title": "Contact form",
    "contacts.form.lead": "Fill out the form and we will respond during business hours.",
    "contacts.form.name": "Name",
    "contacts.form.namePh": "Your name",
    "contacts.form.email": "Email",
    "contacts.form.emailPh": "name@email.com",
    "contacts.form.subject": "Subject",
    "contacts.form.subjectPh": "Services / partnership inquiry",
    "contacts.form.message": "Message",
    "contacts.form.messagePh": "Type your message...",
    "contacts.form.send": "Send",
    "contacts.form.hint": "We will connect secure delivery on the backend (validation + protection)."
  }
};

// ============================
// NEWS DATA (RU/KZ/EN)
// ============================
window.newsData = {
  1: {
    id: 1,
    cat: "official",
    dateISO: "2026-02-01",
    dateText: "01.02.2026",
    image: "../assets/img/renew.png",
    title: {
      ru: "Обновление графика приёма заявок",
      kz: "Өтінім қабылдау кестесінің жаңартылуы",
      en: "Updated application schedule"
    },
    desc: {
      ru: "Опубликован новый порядок обработки заявок и сроки ответа для заявителей.",
      kz: "Өтінімдерді өңдеудің жаңа тәртібі және өтініш берушілерге жауап беру мерзімдері жарияланды.",
      en: "A new procedure for processing applications and response timelines has been published."
    },
    body: {
      ru: `
        <p>Сообщаем о внесении изменений в порядок обработки обращений и заявок.</p>
        <p><strong>Что изменилось:</strong></p>
        <ul>
          <li>уточнены сроки рассмотрения заявок;</li>
          <li>обновлены требования к комплекту документов;</li>
          <li>введены дополнительные каналы информирования заявителей.</li>
        </ul>
        <p>Просим учитывать обновления при подаче обращений. Подробности можно уточнить в разделе «Контакты».</p>
      `,
      kz: `
        <p>Өтініштер мен өтінімдерді өңдеу тәртібіне өзгерістер енгізілгенін хабарлаймыз.</p>
        <p><strong>Не өзгерді:</strong></p>
        <ul>
          <li>өтінімдерді қарау мерзімдері нақтыланды;</li>
          <li>құжаттар топтамасына қойылатын талаптар жаңартылды;</li>
          <li>өтініш берушілерді хабардар ету арналары кеңейтілді.</li>
        </ul>
        <p>Өтінім беру кезінде жаңартуларды ескеруді сұраймыз. Толық ақпаратты «Байланыс» бөлімінен нақтылауға болады.</p>
      `,
      en: `
        <p>We inform you that the procedure for processing requests and applications has been updated.</p>
        <p><strong>What has changed:</strong></p>
        <ul>
          <li>application review timelines were updated;</li>
          <li>document package requirements were updated;</li>
          <li>additional notification channels were introduced.</li>
        </ul>
        <p>Please consider these updates when submitting requests. For details, see the “Contacts” section.</p>
      `
    }
  },

  2: {
    id: 2,
    cat: "announce",
    dateISO: "2026-01-20",
    dateText: "20.01.2026",
    image: "../assets/img/website.png",
    title: {
      ru: "Объявление о технических работах",
      kz: "Техникалық жұмыстар туралы хабарландыру",
      en: "Maintenance notice"
    },
    desc: {
      ru: "Возможны кратковременные перебои в работе сайта в связи с обновлением инфраструктуры.",
      kz: "Инфрақұрылымды жаңарту жұмыстарына байланысты сайт жұмысы уақытша кідірісі мүмкін.",
      en: "Temporary interruptions may occur due to infrastructure updates."
    },
    body: {
      ru: `
        <p>В период проведения плановых технических работ возможны кратковременные перебои в доступе к сайту.</p>
        <p><strong>Рекомендуем:</strong></p>
        <ul>
          <li>при необходимости повторить попытку позже;</li>
          <li>по срочным вопросам обращаться по телефону, указанному в шапке сайта;</li>
          <li>использовать альтернативные каналы связи (email).</li>
        </ul>
        <p>Приносим извинения за возможные неудобства.</p>
      `,
      kz: `
        <p>Жоспарлы техникалық жұмыстар кезінде сайтқа қолжетімділік қысқа уақытқа шектелуі мүмкін.</p>
        <p><strong>Ұсыныс:</strong></p>
        <ul>
          <li>қажет болса, кейінірек қайта кіріп көру;</li>
          <li>шұғыл сұрақтар бойынша сайттың жоғарғы бөлігіндегі телефонға хабарласу;</li>
          <li>баламалы байланыс арналарын пайдалану (email).</li>
        </ul>
        <p>Түсіністік танытқандарыңыз үшін рахмет.</p>
      `,
      en: `
        <p>During scheduled maintenance, short-term website access interruptions may occur.</p>
        <p><strong>We recommend:</strong></p>
        <ul>
          <li>trying again later if needed;</li>
          <li>contacting us by phone for urgent matters;</li>
          <li>using alternative channels (email).</li>
        </ul>
        <p>We apologize for any inconvenience.</p>
      `
    }
  },

  3: {
    id: 3,
    cat: "press",
    dateISO: "2025-12-10",
    dateText: "10.12.2025",
    image: "../assets/img/newmethod.png",
    title: {
      ru: "Внедрение новых методов диагностики",
      kz: "Диагностиканың жаңа әдістерін енгізу",
      en: "Implementation of new diagnostic methods"
    },
    desc: {
      ru: "Лаборатория расширяет перечень исследований, повышая точность и скорость результатов.",
      kz: "Зертхана зерттеу түрлерін кеңейтіп, нәтижелердің дәлдігі мен жылдамдығын арттырады.",
      en: "The laboratory expands its testing portfolio, improving accuracy and turnaround time."
    },
    body: {
      ru: `
        <p>Лаборатория продолжает развитие и расширяет перечень диагностических исследований.</p>
        <p><strong>Ключевые улучшения:</strong></p>
        <ul>
          <li>повышение точности результатов;</li>
          <li>сокращение сроков получения заключений;</li>
          <li>расширение спектра доступных методик.</li>
        </ul>
        <p>Следите за обновлениями в разделе «Услуги» и на странице «Новости».</p>
      `,
      kz: `
        <p>Зертхана дамуын жалғастырып, диагностикалық зерттеулер тізімін кеңейтуде.</p>
        <p><strong>Негізгі жақсартулар:</strong></p>
        <ul>
          <li>нәтижелердің дәлдігін арттыру;</li>
          <li>қорытындыларды алу мерзімін қысқарту;</li>
          <li>қолжетімді әдістемелер ауқымын кеңейту.</li>
        </ul>
        <p>Жаңартуларды «Қызметтер» және «Жаңалықтар» бөлімдерінен қадағалаңыз.</p>
      `,
      en: `
        <p>The laboratory continues to grow and expands its range of diagnostic tests.</p>
        <p><strong>Key improvements:</strong></p>
        <ul>
          <li>higher accuracy of results;</li>
          <li>faster turnaround time;</li>
          <li>broader set of available methods.</li>
        </ul>
        <p>Follow updates in the “Services” section and on the “News” page.</p>
      `
    }
  }
};

// ===== ГЛОБАЛЬНЫЕ ФУНКЦИИ =====

function getCurrentLang() {
  return document.documentElement.dataset.lang || localStorage.getItem("lang") || "ru";
}

function norm(s) {
  return (s || "")
    .toString()
    .toLowerCase()
    .normalize("NFKD")
    .replace(/[\u0300-\u036f]/g, "")
    .replace(/\s+/g, " ")
    .trim();
}

// ===== КАТЕГОРИИ НОВОСТЕЙ =====

function newsCatLabel(cat, lang) {
  const labels = {
    official: { ru: "Официально", kz: "Ресми", en: "Official" },
    announce: { ru: "Объявление", kz: "Хабарландыру", en: "Announcement" },
    press: { ru: "Пресс-релиз", kz: "Пресс-релиз", en: "Press release" }
  };
  return labels[cat]?.[lang] || labels[cat]?.ru || cat;
}

// ===== РЕНДЕРИНГ НОВОСТЕЙ =====

function renderNewsList() {
  const grid = document.getElementById("newsGrid");
  if (!grid) return;

  const lang = getCurrentLang();
  const items = Object.values(window.newsData).sort((a, b) => (a.dateISO < b.dateISO ? 1 : -1));

  grid.innerHTML = items.map(n => {
    const catLabel = newsCatLabel(n.cat, lang);
    const readMoreText = lang === "kz" ? "Толығырақ оқу →" : 
                         lang === "en" ? "Read more →" : 
                         "Читать подробнее →";
    
    return `
      <article class="news-card" data-cat="${n.cat}">
        <div class="news-card__meta">
          <span class="tag news-card__tag news-card__tag--${n.cat}">${catLabel}</span>
          <time class="news-card__date" datetime="${n.dateISO}">${n.dateText}</time>
        </div>
        <h3 class="news-card__title">${n.title[lang] || n.title.ru}</h3>
        <p class="news-card__desc">${n.desc[lang] || n.desc.ru}</p>
        <a class="link news-card__link" href="news-item.html?id=${n.id}">${readMoreText}</a>
      </article>
    `;
  }).join("");
  
  // Перестраиваем поисковый индекс для новостей
  rebuildNewsSearchIndex(lang);
}

function rebuildNewsSearchIndex(lang) {
  const cards = document.querySelectorAll(".news-card");
  cards.forEach((card, index) => {
    const newsItem = window.newsData[index + 1];
    if (newsItem) {
      const title = newsItem.title[lang] || newsItem.title.ru;
      const desc = newsItem.desc[lang] || newsItem.desc.ru;
      const searchText = norm(title + " " + desc + " " + newsItem.cat);
      card.dataset.search = searchText;
    }
  });
}

// ===== ФИЛЬТРАЦИЯ НОВОСТЕЙ =====

function initNewsFilters() {
  const grid = document.getElementById("newsGrid");
  if (!grid) return;

  const searchInput = document.getElementById("newsSearch");
  const categorySelect = document.getElementById("newsCategory");
  const chipsContainer = document.getElementById("newsChips");
  const resetBtn = document.getElementById("newsClear");
  const emptyState = document.getElementById("newsEmpty");

  let currentCategory = "all";
  let currentSearch = "";

  function updateEmptyState(visibleCount) {
    if (emptyState) {
      const lang = getCurrentLang();
      const titleEl = emptyState.querySelector(".empty-title");
      const descEl = emptyState.querySelector(".empty-desc");
      
      if (titleEl) titleEl.textContent = translations[lang]?.["news.empty.title"] || "Ничего не найдено";
      if (descEl) descEl.textContent = translations[lang]?.["news.empty.desc"] || "Попробуйте изменить запрос или выбрать другую категорию.";
      
      emptyState.style.display = visibleCount === 0 ? "block" : "none";
    }
  }

  window.applyNewsFilters = function() {
    const cards = Array.from(grid.querySelectorAll(".news-card"));
    let visibleCount = 0;

    cards.forEach(card => {
      const cardCategories = [card.dataset.cat || ""];
      
      const categoryMatch = currentCategory === "all" || cardCategories.includes(currentCategory);
      const cardText = norm(card.dataset.search || card.textContent);
      const searchMatch = !currentSearch || cardText.includes(currentSearch);
      
      const shouldShow = categoryMatch && searchMatch;
      card.style.display = shouldShow ? "" : "none";
      
      if (shouldShow) visibleCount++;
    });

    updateEmptyState(visibleCount);
  };

  function setCategory(cat) {
    currentCategory = cat || "all";
    
    if (categorySelect) categorySelect.value = currentCategory;
    
    if (chipsContainer) {
      chipsContainer.querySelectorAll(".chip").forEach(btn => {
        btn.classList.toggle("is-active", btn.dataset.chip === currentCategory);
      });
    }
    
    window.applyNewsFilters();
  }

  if (searchInput) {
    searchInput.addEventListener("input", (e) => {
      currentSearch = norm(e.target.value);
      window.applyNewsFilters();
    });
  }

  if (categorySelect) {
    categorySelect.addEventListener("change", () => setCategory(categorySelect.value));
  }

  if (chipsContainer) {
    chipsContainer.addEventListener("click", (e) => {
      const btn = e.target.closest(".chip");
      if (!btn) return;
      setCategory(btn.dataset.chip);
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      if (searchInput) {
        searchInput.value = "";
        currentSearch = "";
      }
      setCategory("all");
    });
  }

  // Инициализация
  setCategory("all");
}

// ===== ОБНОВЛЕНИЕ СТРАНИЦЫ НОВОСТЕЙ =====

function updateNewsPage(lang) {
  if (!document.getElementById("newsGrid")) return;
  
  // Обновляем заголовок страницы
  const titleElement = document.querySelector("h1");
  if (titleElement && !titleElement.hasAttribute("data-i18n")) {
    titleElement.textContent = translations[lang]?.["news.title"] || "Новости";
  }
  
  // Обновляем описание
  const leadElement = document.querySelector(".news-lead");
  if (leadElement && !leadElement.hasAttribute("data-i18n")) {
    leadElement.textContent = translations[lang]?.["news.lead"] || "Официальные новости, объявления и пресс-релизы.";
  }
  
  // Обновляем заголовок страницы в <title>
  const pageTitle = translations[lang]?.["news.pageTitle"];
  if (pageTitle && document.title.includes("Новости")) {
    document.title = pageTitle;
  }
  
  // Обновляем фильтры
  updateNewsFilters(lang);
  
  // Перерисовываем список новостей
  renderNewsList();
  
  // Применяем фильтры
  if (window.applyNewsFilters) {
    window.applyNewsFilters();
  }
}

function updateNewsFilters(lang) {
  // Обновляем placeholder поиска
  const searchInput = document.getElementById("newsSearch");
  if (searchInput && !searchInput.hasAttribute("data-i18n-placeholder")) {
    searchInput.placeholder = translations[lang]?.["news.search.placeholder"] || "Поиск по новостям...";
  }
  
  // Обновляем label для категории
  const categoryLabel = document.querySelector("label[for='newsCategory']");
  if (categoryLabel && !categoryLabel.hasAttribute("data-i18n")) {
    categoryLabel.textContent = translations[lang]?.["news.category.label"] || "Категория";
  }
  
  // Обновляем опции в select
  const categorySelect = document.getElementById("newsCategory");
  if (categorySelect) {
    Array.from(categorySelect.options).forEach(option => {
      const value = option.value;
      let translationKey = "";
      
      switch(value) {
        case "all": translationKey = "news.cat.all"; break;
        case "official": translationKey = "news.cat.official"; break;
        case "announce": translationKey = "news.cat.announce"; break;
        case "press": translationKey = "news.cat.press"; break;
      }
      
      if (translationKey && translations[lang]?.[translationKey]) {
        option.textContent = translations[lang][translationKey];
      }
    });
  }
  
  // Обновляем кнопку сброса
  const resetBtn = document.getElementById("newsClear");
  if (resetBtn && !resetBtn.hasAttribute("data-i18n")) {
    resetBtn.textContent = translations[lang]?.["news.reset"] || "Сбросить";
  }
  
  // Обновляем чипсы
  const chipsContainer = document.getElementById("newsChips");
  if (chipsContainer) {
    chipsContainer.querySelectorAll(".chip").forEach(chip => {
      const filterValue = chip.dataset.chip;
      let translationKey = "";
      
      switch(filterValue) {
        case "all": translationKey = "news.cat.all"; break;
        case "official": translationKey = "news.cat.official"; break;
        case "announce": translationKey = "news.cat.announce"; break;
        case "press": translationKey = "news.cat.press"; break;
      }
      
      if (translationKey && translations[lang]?.[translationKey]) {
        chip.textContent = translations[lang][translationKey];
      }
    });
  }
}

// ===== ОСНОВНАЯ ФУНКЦИЯ ПЕРЕВОДА =====

function setLang(lang) {
  // Устанавливаем атрибуты и сохраняем язык
  document.documentElement.setAttribute("lang", lang === "kz" ? "kk" : lang);
  document.documentElement.dataset.lang = lang;
  localStorage.setItem("lang", lang);

  // 1. Обновляем текстовые элементы
  document.querySelectorAll("[data-i18n]").forEach(el => {
    const key = el.getAttribute("data-i18n");
    const value = translations[lang]?.[key];
    if (value != null) el.textContent = value;
  });

  // 2. Обновляем placeholder'ы
  document.querySelectorAll("[data-i18n-placeholder]").forEach(el => {
    const key = el.getAttribute("data-i18n-placeholder");
    const value = translations[lang]?.[key];
    if (value != null) el.setAttribute("placeholder", value);
  });

  // 3. Обновляем кнопки выбора языка
  document.querySelectorAll("[data-lang-btn]").forEach(btn => {
    btn.classList.toggle("is-active", btn.dataset.langBtn === lang);
  });

  // 4. Обновляем заголовок страницы услуг
  updateServicesPageTitle(lang);
  
  // 5. Обновляем фильтры услуг
  updateServicesFilters(lang);
  
  // 6. Обновляем карточки услуг
  if (window.updateServicesCards) {
    window.updateServicesCards(lang);
  }
  
  // 7. Обновляем страницу новостей
  updateNewsPage(lang);
  
  // 8. Перестраиваем поисковый индекс
  if (window.rebuildSearchIndex) {
    window.rebuildSearchIndex(lang);
  }
  
  // 9. Применяем фильтры (если есть активные)
  if (window.applyServiceFilters) {
    window.applyServiceFilters();
  }
  
  // 10. Применяем фильтры новостей
  if (window.applyNewsFilters) {
    window.applyNewsFilters();
  }
  
  // 11. Обновляем страницу контактов
  updateContactsPage(lang);

  // 12. Триггерим событие для других компонентов
  window.dispatchEvent(new CustomEvent("langchange", { detail: { lang } }));
}

// ===== ОБНОВЛЕНИЕ ЗАГОЛОВКА СТРАНИЦЫ УСЛУГ =====

function updateServicesPageTitle(lang) {
  // Обновляем заголовок h1 на странице услуг
  const pageTitle = document.querySelector("h1");
  if (pageTitle && pageTitle.id !== "year") {
    // Проверяем, какая это страница
    if (document.querySelector(".services-section")) {
      const title = translations[lang]?.["services.page.title"];
      if (title && !pageTitle.hasAttribute("data-i18n")) {
        pageTitle.textContent = title;
      }
    } else if (document.querySelector(".news-section")) {
      const title = translations[lang]?.["news.title"];
      if (title && !pageTitle.hasAttribute("data-i18n")) {
        pageTitle.textContent = title;
      }
    } else if (document.querySelector(".about-section")) {
      const title = translations[lang]?.["about.title"];
      if (title && !pageTitle.hasAttribute("data-i18n")) {
        pageTitle.textContent = title;
      }
    } else if (document.querySelector(".branches-section")) {
      const title = translations[lang]?.["branches.title"];
      if (title && !pageTitle.hasAttribute("data-i18n")) {
        pageTitle.textContent = title;
      }
    } else if (document.querySelector(".training-section")) {
      const title = translations[lang]?.["training.title"];
      if (title && !pageTitle.hasAttribute("data-i18n")) {
        pageTitle.textContent = title;
      }
    } else if (document.querySelector(".proposals-section")) {
      const title = translations[lang]?.["proposals.title"];
      if (title && !pageTitle.hasAttribute("data-i18n")) {
        pageTitle.textContent = title;
      }
    } else if (document.querySelector(".contacts-section")) {
      const title = translations[lang]?.["contacts.title"];
      if (title && !pageTitle.hasAttribute("data-i18n")) {
        pageTitle.textContent = title;
      }
    }
  }
}

// ===== ОБНОВЛЕНИЕ СТРАНИЦЫ КОНТАКТОВ =====

function updateContactsPage(lang) {
  // Проверяем, находимся ли на странице контактов
  if (!document.querySelector(".contacts-section")) return;
  
  // Обновляем описание (lead)
  const leadElement = document.querySelector(".contacts-lead");
  if (leadElement && !leadElement.hasAttribute("data-i18n")) {
    leadElement.textContent = translations[lang]?.["contacts.lead"] || 
                               "Свяжитесь с нами по телефону или отправьте обращение через форму.";
  }
  
  // Обновляем заголовок контактной информации
  const infoTitle = document.querySelector(".contacts-info__title");
  if (infoTitle && !infoTitle.hasAttribute("data-i18n")) {
    infoTitle.textContent = translations[lang]?.["contacts.info.title"] || "Контактная информация";
  }
  
  // Обновляем поля контактной информации
  document.querySelectorAll(".contacts-info__item").forEach(item => {
    const label = item.querySelector(".contacts-info__label");
    const value = item.querySelector(".contacts-info__value");
    
    if (label) {
      const labelText = label.textContent.trim();
      let translationKey = "";
      
      if (labelText.includes("Телефон") || labelText.includes("Phone") || labelText.includes("Телефон")) {
        translationKey = "contacts.info.phone";
      } else if (labelText.includes("Email") || labelText.includes("E-mail")) {
        translationKey = "contacts.info.email";
      } else if (labelText.includes("Адрес") || labelText.includes("Address") || 
                 labelText.includes("Мекенжай")) {
        translationKey = "contacts.info.address";
      } else if (labelText.includes("Режим") || labelText.includes("Working") || 
                 labelText.includes("Жұмыс")) {
        translationKey = "contacts.info.hours";
      }
      
      if (translationKey && translations[lang]?.[translationKey]) {
        label.textContent = translations[lang][translationKey];
      }
    }
    
    if (value) {
      const valueText = value.textContent.trim();
      if (valueText.includes("Казахстан, г. Астана") || 
          valueText.includes("Қазақстан, Астана") || 
          valueText.includes("Kazakhstan, Astana")) {
        value.textContent = translations[lang]?.["contacts.info.addressValue"] || valueText;
      } else if (valueText.includes("Пн–Пт: 09:00–18:00") || 
                 valueText.includes("Дс–Жм: 09:00–18:00") || 
                 valueText.includes("Mon–Fri: 09:00–18:00")) {
        value.textContent = translations[lang]?.["contacts.info.hoursValue"] || valueText;
      }
    }
  });
  
  // Обновляем кнопки
  document.querySelectorAll(".btn").forEach(btn => {
    const btnText = btn.textContent.trim();
    let translationKey = "";
    
    if (btnText.includes("Написать письмо") || btnText.includes("Хат жазу") || btnText.includes("Send email")) {
      translationKey = "contacts.btn.email";
    } else if (btnText.includes("Позвонить") || btnText.includes("Қоңырау шалу") || btnText.includes("Call")) {
      translationKey = "contacts.btn.call";
    }
    
    if (translationKey && translations[lang]?.[translationKey]) {
      btn.textContent = translations[lang][translationKey];
    }
  });
  
  // Обновляем заголовок карты
  const mapTitle = document.querySelector(".contacts-map__title");
  if (mapTitle && !mapTitle.hasAttribute("data-i18n")) {
    mapTitle.textContent = translations[lang]?.["contacts.map.title"] || "Карта";
  }
  
  // Обновляем заглушку карты
  const stubTitle = document.querySelector(".contacts-map__stub-title");
  const stubText = document.querySelector(".contacts-map__stub-text");
  const stubHint = document.querySelector(".contacts-map__hint");
  
  if (stubTitle && !stubTitle.hasAttribute("data-i18n")) {
    stubTitle.textContent = translations[lang]?.["contacts.map.stubTitle"] || "Карта будет добавлена";
  }
  if (stubText && !stubText.hasAttribute("data-i18n")) {
    stubText.textContent = translations[lang]?.["contacts.map.stubText"] || 
                           "После согласования адреса подключим Яндекс/Google карты.";
  }
  if (stubHint && !stubHint.hasAttribute("data-i18n")) {
    stubHint.textContent = translations[lang]?.["contacts.map.hint"] || 
                           "Для навигации используйте адрес или позвоните в приёмную.";
  }
  
  // Обновляем форму
  updateContactsForm(lang);
}

// ===== ОБНОВЛЕНИЕ ФОРМЫ КОНТАКТОВ =====

function updateContactsForm(lang) {
  const form = document.querySelector(".contacts-form");
  if (!form) return;
  
  // Обновляем заголовок формы
  const formTitle = form.querySelector(".contacts-form__title");
  if (formTitle && !formTitle.hasAttribute("data-i18n")) {
    formTitle.textContent = translations[lang]?.["contacts.form.title"] || "Форма обращения";
  }
  
  // Обновляем описание формы
  const formLead = form.querySelector(".contacts-form__lead");
  if (formLead && !formLead.hasAttribute("data-i18n")) {
    formLead.textContent = translations[lang]?.["contacts.form.lead"] || 
                           "Заполните форму, и мы ответим в рабочее время.";
  }
  
  // Обновляем labels и placeholders
  const fields = form.querySelectorAll(".form-group");
  fields.forEach(field => {
    const label = field.querySelector("label");
    const input = field.querySelector("input, textarea");
    
    if (label) {
      const labelText = label.textContent.trim();
      let translationKey = "";
      
      if (labelText.includes("Имя") || labelText.includes("Аты") || labelText.includes("Name")) {
        translationKey = "contacts.form.name";
      } else if (labelText.includes("Email") || labelText.includes("E-mail")) {
        translationKey = "contacts.form.email";
      } else if (labelText.includes("Тема") || labelText.includes("Тақырып") || labelText.includes("Subject")) {
        translationKey = "contacts.form.subject";
      } else if (labelText.includes("Сообщение") || labelText.includes("Хабарлама") || labelText.includes("Message")) {
        translationKey = "contacts.form.message";
      }
      
      if (translationKey && translations[lang]?.[translationKey]) {
        label.textContent = translations[lang][translationKey];
      }
    }
    
    if (input) {
      const placeholder = input.getAttribute("placeholder");
      if (placeholder) {
        let translationKey = "";
        
        if (placeholder.includes("Ваше имя") || placeholder.includes("Атыңыз") || placeholder.includes("Your name")) {
          translationKey = "contacts.form.namePh";
        } else if (placeholder.includes("name@email.com")) {
          translationKey = "contacts.form.emailPh";
        } else if (placeholder.includes("Вопрос по услугам") || 
                   placeholder.includes("Қызмет / ынтымақтастық") || 
                   placeholder.includes("Services / partnership")) {
          translationKey = "contacts.form.subjectPh";
        } else if (placeholder.includes("Введите сообщение") || 
                   placeholder.includes("Хабарламаны енгізіңіз") || 
                   placeholder.includes("Type your message")) {
          translationKey = "contacts.form.messagePh";
        }
        
        if (translationKey && translations[lang]?.[translationKey]) {
          input.setAttribute("placeholder", translations[lang][translationKey]);
        }
      }
    }
  });
  
  // Обновляем кнопку отправки
  const submitBtn = form.querySelector(".btn[type='submit']");
  if (submitBtn && !submitBtn.hasAttribute("data-i18n")) {
    submitBtn.textContent = translations[lang]?.["contacts.form.send"] || "Отправить";
  }
  
  // Обновляем подсказку
  const formHint = form.querySelector(".form-hint");
  if (formHint && !formHint.hasAttribute("data-i18n")) {
    formHint.textContent = translations[lang]?.["contacts.form.hint"] || 
                           "На бэкенде подключим безопасную отправку (валидация + защита).";
  }
}

// ===== ОБНОВЛЕНИЕ ФИЛЬТРОВ УСЛУГ =====

function updateServicesFilters(lang) {
  // Проверяем, находимся ли на странице услуг
  if (!document.querySelector(".services-section")) return;
  
  // 1. Обновляем заголовок "Категория"
  const categoryLabel = document.querySelector("label[for='serviceCategory']");
  if (categoryLabel && !categoryLabel.hasAttribute("data-i18n")) {
    categoryLabel.textContent = translations[lang]?.["services.filter.category"] || "Категория";
  }
  
  // 2. Обновляем placeholder поиска
  const searchInput = document.getElementById("serviceSearch");
  if (searchInput && !searchInput.hasAttribute("data-i18n-placeholder")) {
    searchInput.placeholder = translations[lang]?.["services.filter.search"] || "Поиск услуги...";
  }
  
  // 3. Обновляем кнопку сброса
  const resetBtn = document.getElementById("serviceReset");
  if (resetBtn && !resetBtn.hasAttribute("data-i18n")) {
    resetBtn.textContent = translations[lang]?.["services.filter.reset"] || "Сбросить";
  }
  
  // 4. Обновляем опции в select
  updateSelectOptions(lang, "serviceCategory");
  
  // 5. Обновляем чипсы (кнопки фильтров)
  updateFilterChips(lang, "serviceChips");
}

function updateSelectOptions(lang, selectId) {
  const select = document.getElementById(selectId);
  if (!select) return;
  
  const currentValue = select.value;
  const isNews = selectId === "newsCategory";
  
  Array.from(select.options).forEach(option => {
    const value = option.value;
    let translationKey = "";
    
    if (isNews) {
      switch(value) {
        case "all": translationKey = "news.cat.all"; break;
        case "official": translationKey = "news.cat.official"; break;
        case "announce": translationKey = "news.cat.announce"; break;
        case "press": translationKey = "news.cat.press"; break;
        default: return;
      }
    } else {
      switch(value) {
        case "all": translationKey = "services.filter.all"; break;
        case "lab": translationKey = "services.filter.lab"; break;
        case "pcr": translationKey = "services.filter.pcr"; break;
        case "micro": translationKey = "services.filter.micro"; break;
        case "bio": translationKey = "services.filter.bio"; break;
        case "hema": translationKey = "services.filter.hema"; break;
        case "consult": translationKey = "services.filter.consult"; break;
        default: return;
      }
    }
    
    if (translations[lang]?.[translationKey]) {
      option.textContent = translations[lang][translationKey];
    }
  });
  
  select.value = currentValue;
}

function updateFilterChips(lang, chipsContainerId) {
  const chipsContainer = document.getElementById(chipsContainerId);
  if (!chipsContainer) return;
  
  const isNews = chipsContainerId === "newsChips";
  
  chipsContainer.querySelectorAll(".chip, .services-chip").forEach(chip => {
    const filterValue = chip.dataset.chip || chip.dataset.filter;
    let translationKey = "";
    
    if (isNews) {
      switch(filterValue) {
        case "all": translationKey = "news.cat.all"; break;
        case "official": translationKey = "news.cat.official"; break;
        case "announce": translationKey = "news.cat.announce"; break;
        case "press": translationKey = "news.cat.press"; break;
        default: return;
      }
    } else {
      switch(filterValue) {
        case "all": translationKey = "services.filter.all"; break;
        case "lab": translationKey = "services.filter.lab"; break;
        case "pcr": translationKey = "services.filter.pcr"; break;
        case "micro": translationKey = "services.filter.micro"; break;
        case "bio": translationKey = "services.filter.bio"; break;
        case "hema": translationKey = "services.filter.hema"; break;
        case "consult": translationKey = "services.filter.consult"; break;
        default: return;
      }
    }
    
    if (translations[lang]?.[translationKey]) {
      chip.textContent = translations[lang][translationKey];
    }
  });
}

// ===== УПРАВЛЕНИЕ УСЛУГАМИ =====

const servicesData = [
  {
    id: "hema",
    cats: ["hema", "lab"],
    img: "../assets/img/gematology.png",
    tags: ["hema", "lab"],
    title: {
      ru: "Гематологические исследования",
      kz: "Гематологиялық зерттеулер",
      en: "Hematology tests"
    },
    desc: {
      ru: "Исследования крови животных: основные показатели, оценка состояния организма.",
      kz: "Жануар қанының негізгі көрсеткіштері және организм жағдайын бағалау.",
      en: "Blood testing: key indicators and assessment of animal health status."
    },
    btn: "request"
  },
  {
    id: "bio",
    cats: ["bio", "lab"],
    img: "../assets/img/biochemia.png",
    tags: ["bio", "lab"],
    title: {
      ru: "Биохимические исследования",
      kz: "Биохимиялық зерттеулер",
      en: "Biochemistry tests"
    },
    desc: {
      ru: "Показатели биохимии: ферменты, белки, электролиты и другие параметры.",
      kz: "Ферменттер, ақуыздар, электролиттер және басқа да биохимиялық көрсеткіштер.",
      en: "Biochemistry markers: enzymes, proteins, electrolytes and other parameters."
    },
    btn: "request"
  },
  {
    id: "pcr",
    cats: ["pcr", "lab"],
    img: "../assets/img/PCR.png",
    tags: ["pcr", "lab"],
    title: {
      ru: "ПЦР диагностика",
      kz: "ПТР диагностика",
      en: "PCR diagnostics"
    },
    desc: {
      ru: "Молекулярная диагностика инфекций и патогенов с высокой точностью.",
      kz: "Инфекциялар мен қоздырғыштарды жоғары дәлдікпен молекулалық анықтау.",
      en: "High-accuracy molecular diagnostics of infections and pathogens."
    },
    btn: "request"
  },
  {
    id: "micro",
    cats: ["micro", "lab"],
    img: "../assets/img/microbio.png",
    tags: ["micro", "lab"],
    title: {
      ru: "Микробиологические исследования",
      kz: "Микробиологиялық зерттеулер",
      en: "Microbiology tests"
    },
    desc: {
      ru: "Выделение культур, идентификация, тестирование чувствительности к препаратам.",
      kz: "Дақыл бөлу, сәйкестендіру және препараттарға сезімталдықты анықтау.",
      en: "Culture isolation, identification, and antimicrobial susceptibility testing."
    },
    btn: "request"
  },
  {
    id: "sero",
    cats: ["lab"],
    img: "../assets/img/sero.png",
    tags: ["lab"],
    title: {
      ru: "Серологические исследования",
      kz: "Серологиялық зерттеулер",
      en: "Serology tests"
    },
    desc: {
      ru: "Оценка иммунного ответа, выявление антител, мониторинг заболеваний.",
      kz: "Антиденелерді анықтау, иммундық жауапты бағалау және мониторинг.",
      en: "Immune response assessment, antibody detection, and disease monitoring."
    },
    btn: "request"
  },
  {
    id: "support",
    cats: ["consult"],
    img: "../assets/img/method.png",
    tags: ["consult"],
    title: {
      ru: "Методическое сопровождение",
      kz: "Әдістемелік сүйемелдеу",
      en: "Methodological support"
    },
    desc: {
      ru: "Консультации, разъяснения, методические материалы и обучение.",
      kz: "Кеңес беру, түсіндіру, әдістемелік материалдар және оқыту.",
      en: "Consultations, guidance, materials, and training."
    },
    btn: "contact"
  }
];

const serviceTagsI18n = {
  lab: { ru: "Лаборатория", kz: "Зертхана", en: "Laboratory" },
  hema: { ru: "Гематология", kz: "Гематология", en: "Hematology" },
  bio: { ru: "Биохимия", kz: "Биохимия", en: "Biochemistry" },
  pcr: { ru: "ПЦР", kz: "ПТР", en: "PCR" },
  micro: { ru: "Микробиология", kz: "Микробиология", en: "Microbiology" },
  consult: { ru: "Сопровождение", kz: "Сүйемелдеу", en: "Support" }
};

function renderServices(lang = null) {
  const grid = document.getElementById("servicesGrid");
  if (!grid) return;

  const currentLang = lang || getCurrentLang();

  grid.innerHTML = servicesData.map(s => {
    const tagsHtml = (s.tags || []).map(t => {
      const label = serviceTagsI18n[t]?.[currentLang] || serviceTagsI18n[t]?.ru || t;
      return `<span class="tag">${label}</span>`;
    }).join("");

    const btnText = s.btn === "contact"
      ? translations[currentLang]?.["services.btn.contact"] || 
        (currentLang === "kz" ? "Байланысу" : currentLang === "en" ? "Contact" : "Связаться")
      : translations[currentLang]?.["services.btn.request"] || 
        (currentLang === "kz" ? "Қызметке өтінім беру" : currentLang === "en" ? "Request service" : "Запросить услугу");

    const title = translations[currentLang]?.[`services.${s.id}.title`] || 
                  s.title?.[currentLang] || 
                  s.title?.ru || 
                  "";
    
    const desc = translations[currentLang]?.[`services.${s.id}.desc`] || 
                 s.desc?.[currentLang] || 
                 s.desc?.ru || 
                 "";

    return `
      <article class="service-card" data-cat="${(s.cats || []).join(" ")}" data-id="${s.id}">
        <div class="service-card__img" style="background-image:url('${s.img}')"></div>
        <div class="service-card__body">
          <h3 class="service-card__title">${title}</h3>
          <p class="service-card__desc">${desc}</p>
          <div class="service-card__meta">${tagsHtml}</div>
          <a class="btn btn--primary service-card__btn" href="contacts.html">${btnText}</a>
        </div>
      </article>
    `;
  }).join("");

  // Инициализируем фильтрацию после рендеринга
  if (window.initServicesFilter) {
    window.initServicesFilter();
  }
}

// ===== ФИЛЬТРАЦИЯ УСЛУГ =====

function initServicesFilter() {
  const grid = document.getElementById("servicesGrid");
  if (!grid) return;

  const searchInput = document.getElementById("serviceSearch");
  const categorySelect = document.getElementById("serviceCategory");
  const chipsContainer = document.getElementById("serviceChips");
  const resetBtn = document.getElementById("serviceReset");
  const emptyState = document.getElementById("emptyState");

  let currentCategory = "all";
  let currentSearch = "";

  window.applyServiceFilters = function() {
    const cards = Array.from(grid.querySelectorAll(".service-card"));
    let visibleCount = 0;

    cards.forEach(card => {
      const cardCategories = (card.dataset.cat || "").split(/\s+/).filter(Boolean);
      
      const categoryMatch = currentCategory === "all" || cardCategories.includes(currentCategory);
      const cardText = norm(card.textContent);
      const searchMatch = !currentSearch || cardText.includes(currentSearch);
      
      const shouldShow = categoryMatch && searchMatch;
      card.style.display = shouldShow ? "" : "none";
      
      if (shouldShow) visibleCount++;
    });

    if (emptyState) {
      const lang = getCurrentLang();
      emptyState.textContent = translations[lang]?.["services.empty"] || "Услуги не найдены";
      emptyState.style.display = visibleCount === 0 ? "block" : "none";
    }
  };

  if (searchInput) {
    searchInput.addEventListener("input", (e) => {
      currentSearch = norm(e.target.value);
      window.applyServiceFilters();
    });
  }

  if (categorySelect) {
    categorySelect.addEventListener("change", (e) => {
      currentCategory = e.target.value || "all";
      
      if (chipsContainer) {
        chipsContainer.querySelectorAll(".services-chip").forEach(chip => {
          chip.classList.toggle("is-active", chip.dataset.filter === currentCategory);
        });
      }
      
      window.applyServiceFilters();
    });
  }

  if (chipsContainer) {
    chipsContainer.addEventListener("click", (e) => {
      const chip = e.target.closest(".services-chip");
      if (!chip) return;
      
      currentCategory = chip.dataset.filter || "all";
      
      if (categorySelect) {
        categorySelect.value = currentCategory;
      }
      
      chipsContainer.querySelectorAll(".services-chip").forEach(c => {
        c.classList.toggle("is-active", c.dataset.filter === currentCategory);
      });
      
      window.applyServiceFilters();
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      currentCategory = "all";
      currentSearch = "";
      
      if (searchInput) searchInput.value = "";
      if (categorySelect) categorySelect.value = "all";
      
      if (chipsContainer) {
        chipsContainer.querySelectorAll(".services-chip").forEach(chip => {
          chip.classList.toggle("is-active", chip.dataset.filter === "all");
        });
      }
      
      window.applyServiceFilters();
    });
  }

  window.applyServiceFilters();
}

// ===== ГЛОБАЛЬНЫЕ ФУНКЦИИ ДЛЯ ОБНОВЛЕНИЯ =====

window.updateServicesContent = function(lang) {
  if (document.getElementById("servicesGrid")) {
    renderServices(lang);
  }
};

window.updateServicesCards = function(lang) {
  const cards = document.querySelectorAll(".service-card");
  if (cards.length === 0) return;
  
  cards.forEach(card => {
    const cardId = card.dataset.id;
    if (!cardId) return;
    
    const service = servicesData.find(s => s.id === cardId);
    if (!service) return;
    
    const titleEl = card.querySelector(".service-card__title");
    if (titleEl) {
      titleEl.textContent = translations[lang]?.[`services.${cardId}.title`] || 
                            service.title?.[lang] || 
                            service.title?.ru || 
                            "";
    }
    
    const descEl = card.querySelector(".service-card__desc");
    if (descEl) {
      descEl.textContent = translations[lang]?.[`services.${cardId}.desc`] || 
                           service.desc?.[lang] || 
                           service.desc?.ru || 
                           "";
    }
    
    const tagsEl = card.querySelector(".service-card__meta");
    if (tagsEl && service.tags) {
      const tagsHtml = service.tags.map(t => {
        const label = serviceTagsI18n[t]?.[lang] || serviceTagsI18n[t]?.ru || t;
        return `<span class="tag">${label}</span>`;
      }).join("");
      tagsEl.innerHTML = tagsHtml;
    }
    
    const btnEl = card.querySelector(".service-card__btn");
    if (btnEl) {
      btnEl.textContent = service.btn === "contact"
        ? translations[lang]?.["services.btn.contact"] || 
          (lang === "kz" ? "Байланысу" : lang === "en" ? "Contact" : "Связаться")
        : translations[lang]?.["services.btn.request"] || 
          (lang === "kz" ? "Қызметке өтінім беру" : lang === "en" ? "Request service" : "Запросить услугу");
    }
  });
};

window.rebuildSearchIndex = function(lang) {
  // Перестраиваем поисковый индекс для услуг
  const serviceCards = document.querySelectorAll(".service-card");
  serviceCards.forEach(card => {
    const cardId = card.dataset.id;
    if (!cardId) return;
    
    const service = servicesData.find(s => s.id === cardId);
    if (!service) return;
    
    const title = translations[lang]?.[`services.${cardId}.title`] || service.title?.[lang] || service.title?.ru || "";
    const desc = translations[lang]?.[`services.${cardId}.desc`] || service.desc?.[lang] || service.desc?.ru || "";
    
    const searchText = norm(
      title + " " +
      desc + " " +
      (service.cats || []).join(" ")
    );
    
    card.dataset.searchText = searchText;
  });
  
  // Перестраиваем поисковый индекс для новостей
  rebuildNewsSearchIndex(lang);
};

// ===== ИНИЦИАЛИЗАЦИЯ =====

document.addEventListener("DOMContentLoaded", () => {
  // Устанавливаем год в футере
  const yearEl = document.getElementById("year");
  if (yearEl) {
    yearEl.textContent = new Date().getFullYear();
  }

  // Инициализируем бургер-меню
  const burger = document.getElementById("burger");
  const nav = document.getElementById("nav");

  if (burger && nav) {
    burger.addEventListener("click", () => {
      nav.classList.toggle("nav--open");
      burger.classList.toggle("burger--open");
    });

    nav.querySelectorAll("a").forEach(a => {
      a.addEventListener("click", () => {
        nav.classList.remove("nav--open");
        burger.classList.remove("burger--open");
      });
    });

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        nav.classList.remove("nav--open");
        burger.classList.remove("burger--open");
      }
    });
  }

  // Вешаем обработчики на кнопки выбора языка
  document.querySelectorAll("[data-lang-btn]").forEach(btn => {
    btn.addEventListener("click", () => setLang(btn.dataset.langBtn));
  });

  // Если это страница услуг, рендерим их
  if (document.getElementById("servicesGrid")) {
    renderServices();
    window.initServicesFilter = initServicesFilter;
    initServicesFilter();
  }

  // Если это страница новостей, инициализируем
  if (document.getElementById("newsGrid")) {
    renderNewsList();
    initNewsFilters();
  }

  // Загружаем сохраненный язык
  const savedLang = localStorage.getItem("lang") || "ru";
  setLang(savedLang);
  
  // Устанавливаем активную ссылку в навигации
  setActiveNavLink();
});

// ===== Active menu highlight (gold) =====
function setActiveNavLink() {
  const nav = document.getElementById("nav");
  if (!nav) return;

  const links = Array.from(nav.querySelectorAll("a.nav__link"));
  if (!links.length) return;

  const path = window.location.pathname.split("/").pop() || "index.html";
  const current = path.split("?")[0].split("#")[0] || "index.html";

  links.forEach(a => a.classList.remove("nav__link--gold"));

  let active = links.find(a => {
    const href = (a.getAttribute("href") || "").split("?")[0].split("#")[0];
    return href === current;
  });

  if (!active && (current === "" || current === "index.html")) {
    active = links.find(a => (a.getAttribute("href") || "").includes("index.html"));
  }

  if (active) active.classList.add("nav__link--gold");
}

// Слушаем событие смены языка для обновления новостей
window.addEventListener("langchange", () => {
  renderNewsList();
  if (window.applyNewsFilters) {
    window.applyNewsFilters();
  }
});